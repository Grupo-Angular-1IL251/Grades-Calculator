<div class="form-container">
  <h2>Inserte la información solicitada para comenzar a agregar notas</h2>

  <form [formGroup]="formularioNotas" (ngSubmit)="enviarFormulario()">
    <label for="materia">Materia</label>
    <input id="materia" formControlName="materia" placeholder="Ingrese el nombre de la materia" />
    <div *ngIf="formularioNotas.get('materia')?.invalid && formularioNotas.get('materia')?.touched" class="error">
      ⚠️ La materia no puede estar en blanco.
    </div>

    <!-- PARCIALES -->
    <div class="bloque fila">
      <div class="col-porcentaje">
        <h3>Parciales</h3>
        <label>Porcentaje de los parciales</label>
        <div class="input-porcentaje">
          <input type="number" formControlName="parciales" /> <span>%</span>
        </div>
      </div>
      <div class="col-cantidad">
        <label>Cantidad de parciales</label>
        <input type="number" formControlName="cantidad_parciales" maxlength="3" />
        <div *ngIf="formularioNotas.get('cantidad_parciales')?.errors?.['max'] && formularioNotas.get('cantidad_parciales')?.touched" class="error">
          ⚠️ Máximo 5 parciales por semestre.
        </div>
        <div *ngIf="formularioNotas.get('cantidad_parciales')?.errors?.['min'] && formularioNotas.get('cantidad_parciales')?.touched" class="error">
          ⚠️ Debe haber al menos 1 parcial.
        </div>
      </div>
    </div>

    <!-- ASIGNACIONES -->
    <div class="bloque fila">
      <div class="col-porcentaje">
        <h3>Asignaciones</h3>
        <label>Porcentaje de las asignaciones</label>
        <div class="input-porcentaje">
          <input type="number" formControlName="asignaciones" /> <span>%</span>
        </div>
      </div>
      <div class="col-cantidad">
        <label>Cantidad de asignaciones</label>
        <input type="number" formControlName="cantidad_asignaciones" maxlength="3" />
        <div *ngIf="formularioNotas.get('cantidad_asignaciones')?.errors?.['max'] && formularioNotas.get('cantidad_asignaciones')?.touched" class="error">
          ⚠️ Máximo 30 asignaciones por semestre.
        </div>
        <div *ngIf="formularioNotas.get('cantidad_asignaciones')?.errors?.['min'] && formularioNotas.get('cantidad_asignaciones')?.touched" class="error">
          ⚠️ Debe haber al menos 1 asignación.
        </div>
      </div>
    </div>

    <!-- PORTAFOLIO -->
    <div class="bloque">
      <h3>Portafolio</h3>
      <label>Porcentaje del portafolio</label>
      <div class="input-porcentaje">
        <input type="number" formControlName="portafolio" /> <span>%</span>
      </div>
    </div>

    <!-- SEMESTRAL -->
    <div class="bloque">
      <h3>Semestral</h3>
      <label>Porcentaje del examen semestral</label>
      <div class="input-porcentaje">
        <input type="number" formControlName="semestral" /> <span>%</span>
      </div>
    </div>

    <!-- ERROR TOTAL -->
    <div *ngIf="formularioNotas.errors?.['porcentajeInvalido'] && formularioNotas.touched" class="error">
      ⚠️ La suma total de porcentajes debe ser exactamente 100%.
    </div>

    <p class="nota">
      Si alguna opción de porcentaje no se encuentra dentro de la división que utiliza su profesor, por favor coloque un 0.
    </p>

    <div class="botones">
      <button type="button" (click)="regresar()">Regresar</button>
      <button type="submit" class="enviar" [disabled]="loading">
        {{ loading ? 'Enviando...' : 'Enviar' }}
      </button>
    </div>
  </form>
</div>
